<div class="container-fluid">
  <div class="row-fluid">
    <div class="span9 offset1">
      <h1>New Evidence</h1>  
      <%= nested_form_for @evidence do |f| %>
				
				
				<%= f.fields_for :points, @evidence.points do |builder| %>				 
					  
			      <h4>Debate Details</h4>
				  <%= builder.collection_select :debate_id, @debates, :id, :title, {:selected => @debate.id} %>		
				  <div class="btn-group" data-toggle="buttons-radio">			
					  	  
					  <% if !@supporting.nil? %>
						  <%= label_tag "For the Debate" %>			
						  <%= builder.radio_button :supporting, true, checked: @supporting, class: "btn btn-primary"%> 
						  <%= label_tag "Against the Debate" %>	
						  <%= builder.radio_button :supporting, false, checked: !@supporting, :class => "btn btn-primary" %>
				      <% else %>
						  <%= label_tag "For the Debate" %>			
						  <%= builder.radio_button :supporting, true, class: "btn btn-primary"%> 
						  <%= label_tag "Against the Debate" %>	
						  <%= builder.radio_button :supporting, false, :class => "btn btn-primary" %>
					  <% end %>
						
								
				  </div>
				<%end%>	
		<h4>New Point Details</h4>
        <%= f.error_message_on 'title', prepend_text: 'Title ' %>
        <%= f.text_field :title, :placeholder => "What's my point..." %> 
			<h5>Use Existing Sources </h5>
			<p>Hold Ctrl to select multiple</p>
			<%= f.collection_select :source_ids, @sources, :id, :title, {}, multiple: true %>
			<%= f.fields_for :sources, @evidence.sources.select{|src| src.new_record?} do |s| %>	
						<h5>New Source</h5>
								<%= s.error_message_on 'title', prepend_text: 'Title ' %>
									<%= s.text_field :title, :placeholder => "Title.." %>
									<div>	
								  <p>Authors</p>
								  <%= s.fields_for :authors, (s.object.authors.empty? ? [s.object.authors.build] : s.object.authors) do |authors| %>

									<%= authors.error_message_on 'first_name', prepend_text: 'First name ' %>
									<%= authors.text_field :first_name, :placeholder => "First Name.."%>

									<%= authors.error_message_on 'last_name', prepend_text: 'Last name ' %>
									<%= authors.text_field :last_name, :placeholder => "Last Name.."%>
								  <% end %>
								  <p><%= s.link_to_add 'Add an author', :authors%></p>
								</div>

								<%= s.text_field :citation_count, :placeholder => "Citation count.." %>
								<br />
								<%= s.text_area :description, :rows => 3, :placeholder => "Description.." %>
								<br />
								<%= s.text_field :journal, :placeholder => "Publication.." %>
								<%= s.text_field :year, :placeholder => "Publication year ie:1998" %>
								<br />
								<%= s.text_field :url, :placeholder => "Link..ie:tinyurl.com/nutinyhouse" %>
								<br />
								
				  <% end %>
				   <p><%= f.link_to_add 'Or Create a New Source', :sources %></p>
				
		        <br />		
								
	  
			
	    </div>
	  </div>
	</div>	
	
<div class="container-fluid">
  <div class="row-fluid">
    <div class="span9 offset1">
		<%= hidden_field_tag :debate_id, @debate.id %>
		<%= f.submit "Submit", :class => 'btn' %>
      <% end %>
	  
    </div>
  </div>
</div>

